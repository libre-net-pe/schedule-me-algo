# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a genetic algorithm-based school scheduling system designed to optimize teacher timetables for Peruvian public schools. The system uses evolutionary algorithms to solve complex scheduling constraints including teacher availability, course requirements, and grade-specific needs.

## Development Commands

### Building and Testing
- `npm run build` - Compiles TypeScript to JavaScript in the `lib/` directory
- `npm test` - Runs Jest tests for all components
- `npm test -- --watch` - Runs tests in watch mode for development

### Key Files
- `src/data.yaml` - Sample configuration data with subjects, teachers, grade levels, course requirements, and timetable slots
- `src/index.ts` - Main module exports
- `src/Executor.ts` - Main entry point that orchestrates the genetic algorithm

## Architecture

### Core Genetic Algorithm Components
- **Individual**: Represents a complete schedule solution with chromosome and fitness score (`src/types/genetics/Individual.ts`)
- **Population**: Collection of individuals that evolves over generations 
- **Codec**: Handles encoding/decoding between schedule representations and genetic chromosome format (`src/codec/Codec.ts`)
- **Executor**: Main orchestrator that runs the genetic algorithm with configurable population size and generations (`src/Executor.ts`)

### Strategy Pattern Implementation
The system uses strategy patterns for genetic algorithm components:
- **Selection**: `WheelRouletteSelectionStrategy` - probabilistic selection based on fitness
- **Crossover**: `GlobalCrossoverStrategy` - combines genetic material from parent solutions
- **Mutation**: `RandomMutationStrategy` - introduces random variations
- **Fitness**: `RuleBasedFitnessStrategy` - evaluates schedule quality using multiple constraints

### Constraint System
Fitness evaluation uses multiple constraint metrics in `src/fitness/metrics/`:
- `DuplicatesConstraint` - Prevents scheduling conflicts (same teacher/time)
- `RequirementsConstraint` - Ensures course hour requirements are met
- `PopulationConstraint` - General population-level constraints

### Domain Types
Core scheduling entities in `src/types/`:
- **TimeSlot**: Represents time periods with day, start/end times, duration
- **Offering**: Links teachers to specific course requirements and grade sections
- **Domain entities**: Day, Teacher, Subject, GradeLevel, etc.

## Code Organization

- `src/` - TypeScript source code
- `lib/` - Compiled JavaScript output (generated by build)
- Tests are colocated in `__tests__/` directories within each module
- Path alias `@/*` maps to `src/*` (configured in tsconfig.json and jest.config.mjs)

## Testing Strategy

- Jest is configured with TypeScript support via Babel
- Integration tests in `src/__tests__/Executor.integration.test.ts`
- Unit tests for individual strategies and constraints
- Tests use the path alias `@/*` for imports

## Key Implementation Notes

- The system maintains the best individual across all generations, not just the final generation
- YAML data format is used for configuration input (subjects, teachers, schedules, etc.)
- All time slots are 45-minute periods from 8:00 AM to 3:35 PM across weekdays
- The genetic algorithm supports configurable population sizes and generation limits